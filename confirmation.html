<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Account Created - GuideSignal</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      color: #333;
    }

    .back-link {
      position: absolute;
      top: 20px;
      left: 20px;
      color: white;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      z-index: 100;
    }

    .back-link:hover {
      color: #f0f0f0;
    }

    #main-content {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .confirmation-container {
      width: 100%;
      max-width: 500px;
    }

    .confirmation-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
      padding: 50px 40px;
      text-align: center;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: #10b981;
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
      margin: 0 auto 30px;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    .confirmation-title {
      font-size: 32px;
      font-weight: 700;
      color: #1a365d;
      margin-bottom: 20px;
    }

    .confirmation-message {
      font-size: 18px;
      line-height: 1.6;
      color: #4a5568;
      margin-bottom: 30px;
    }

    .email-info {
      background: #f7fafc;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
    }

    .email-address {
      font-size: 16px;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 10px;
    }

    .email-instructions {
      font-size: 14px;
      color: #718096;
      line-height: 1.5;
    }

    .action-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 30px;
    }

    .btn {
      padding: 14px 28px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      text-decoration: none;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background: #667eea;
      color: white;
    }

    .btn-primary:hover {
      background: #5a67d8;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: transparent;
      color: #667eea;
      border: 2px solid #667eea;
    }

    .btn-secondary:hover {
      background: #667eea;
      color: white;
    }

    .help-section {
      margin-top: 40px;
      padding-top: 30px;
      border-top: 1px solid #e2e8f0;
    }

    .help-title {
      font-size: 18px;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 15px;
    }

    .help-text {
      font-size: 14px;
      color: #718096;
      line-height: 1.5;
      margin-bottom: 10px;
    }

    .contact-link {
      color: #667eea;
      text-decoration: none;
      font-weight: 500;
    }

    .contact-link:hover {
      text-decoration: underline;
    }

    @media (max-width: 480px) {
      .confirmation-card {
        padding: 40px 30px;
        margin: 10px;
      }

      .confirmation-title {
        font-size: 26px;
      }

      .confirmation-message {
        font-size: 16px;
      }

      .action-buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <a href="/" class="back-link">‚Üê Back to Home</a>

  <main id="main-content">
    <div class="confirmation-container">
      <div class="confirmation-card">
        <div class="success-icon">‚úì</div>

        <h1 class="confirmation-title">Account Created Successfully!</h1>

        <p class="confirmation-message">
          Welcome to GuideSignal! Your account has been created and we've sent a verification email to confirm your email address.
        </p>

        <div class="email-info">
          <div class="email-address">
            üìß <span id="user-email">your-email@example.com</span>
          </div>
          <div class="email-instructions">
            Please check your inbox (and spam folder) for a verification email from GuideSignal. Click the verification link to activate your account.
          </div>
        </div>

        <div class="action-buttons">
          <a href="auth.html" class="btn btn-primary">Sign In to Your Account</a>
          <button onclick="resendEmail()" class="btn btn-secondary" id="resend-btn">
            <span class="btn-text">Resend Verification Email</span>
          </button>
        </div>

        <div class="help-section">
          <div class="help-title">Didn't receive the email?</div>
          <p class="help-text">
            ‚Ä¢ Check your spam or junk folder<br>
            ‚Ä¢ Make sure you entered the correct email address<br>
            ‚Ä¢ Wait a few minutes and try again<br>
            ‚Ä¢ <a href="mailto:support@guide-signal.com" class="contact-link">Contact our support team</a>
          </p>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Get user email from URL parameters or localStorage
    function getUserEmail() {
      const urlParams = new URLSearchParams(window.location.search);
      const emailFromURL = urlParams.get('email');
      const emailFromStorage = localStorage.getItem('userEmail');

      return emailFromURL || emailFromStorage || 'your-email@example.com';
    }

    // Display the user's email
    function displayUserEmail() {
      const email = getUserEmail();
      const emailElement = document.getElementById('user-email');
      if (emailElement) {
        emailElement.textContent = email;
      }
    }

    // Resend verification email
    async function resendEmail() {
      const resendBtn = document.getElementById('resend-btn');
      const btnText = resendBtn.querySelector('.btn-text');

      // Disable button and show loading state
      resendBtn.disabled = true;
      btnText.textContent = 'Sending...';

      try {
        // Wait for authFunctions to be available
        while (!window.authFunctions) {
          await new Promise(resolve => setTimeout(resolve, 100));
        }

        const result = await window.authFunctions.resendEmailVerification();

        if (result.success) {
          btnText.textContent = 'Email Sent!';
          setTimeout(() => {
            btnText.textContent = 'Resend Verification Email';
            resendBtn.disabled = false;
          }, 3000);
        } else {
          btnText.textContent = 'Error - Try Again';
          setTimeout(() => {
            btnText.textContent = 'Resend Verification Email';
            resendBtn.disabled = false;
          }, 3000);
        }
      } catch (error) {
        console.error('Resend email error:', error);
        btnText.textContent = 'Error - Try Again';
        setTimeout(() => {
          btnText.textContent = 'Resend Verification Email';
          resendBtn.disabled = false;
        }, 3000);
      }
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      console.log('‚úÖ Confirmation page loaded');
      displayUserEmail();

      // Load Firebase auth functions
      import('./firebase-config.js').then(module => {
        window.authFunctions = module.authFunctions;
        console.log('‚úÖ Firebase functions loaded');
      }).catch(error => {
        console.error('Failed to load Firebase:', error);
      });
    });

    // Handle URL parameters for different confirmation types
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.get('verified') === 'true') {
      // User clicked email verification link
      document.querySelector('.confirmation-title').textContent = 'Email Verified!';
      document.querySelector('.confirmation-message').textContent = 'Great! Your email has been verified. You can now sign in to your GuideSignal account.';
      document.querySelector('.email-info').style.display = 'none';
      document.getElementById('resend-btn').style.display = 'none';
    }
  </script>
</body>
</html>