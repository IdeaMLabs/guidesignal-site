<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Post a Fast-Reply Job</title>
<style>
  body{margin:0;background:#F7F9FC;font:15px system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:#0F172A}
  main{max-width:760px;margin:28px auto;padding:0 16px}
  .card{background:#fff;border:1px solid #e5eaf1;border-radius:16px;padding:22px;box-shadow:0 6px 20px rgba(2,8,23,.06)}
  h1{margin:0 0 8px}
  p.sub{margin:0 0 16px;color:#64748b}
  label{display:block;margin:12px 0 6px}
  input,textarea,select{width:100%;padding:12px;border-radius:10px;border:1px solid #dbe1ea}
  .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:640px){ .row{grid-template-columns:1fr} }
  button{margin-top:14px;padding:12px 16px;border-radius:12px;border:1px solid #0F172A;background:#0F172A;color:#fff;font-weight:700;cursor:pointer}
  small.note{color:#64748b;display:block;margin-top:10px}
</style>

<main>
  <div style="text-align:center;margin-bottom:20px">
    <a href="index.html" style="color:#4a9eff;text-decoration:none;margin-right:20px">‚Üê Home</a>
    <a href="jobs.html" style="color:#4a9eff;text-decoration:none;margin-right:20px">Fast-Reply Jobs</a>
    <a href="how.html" style="color:#4a9eff;text-decoration:none;margin-right:20px">How it Works</a>
    <a href="faq.html" style="color:#4a9eff;text-decoration:none">FAQ</a>
  </div>
  <div class="card" id="wrap">
    <h1>Post a Fast-Reply Job</h1>
    <p class="sub">Fast responses get a <b>Fast-Reply Certified</b> badge and priority placement.</p>

    <form id="jobForm" action="https://formspree.io/f/xvgbzwav" method="POST">
      <!-- Company & Contact -->
      <label>Company
        <input name="company" required placeholder="Your Company Name">
      </label>
      <div class="row">
        <label>Hiring contact (name)
          <input name="contact_name" required placeholder="Your Name">
        </label>
        <label>Contact email
          <input type="email" name="contact_email" required placeholder="your.email@company.com">
        </label>
      </div>

      <!-- Role -->
      <div class="row">
        <label>Role title
          <input name="job_title" required placeholder="Help Desk Technician">
        </label>
        <label>City / Remote
          <input name="job_city" required placeholder="City, State / Remote">
        </label>
      </div>

      <!-- Pay range (use separate fields to match the model) -->
      <div class="row">
        <label>Pay min (hourly)
          <input type="number" step="0.01" name="job_pay_min" required placeholder="15">
        </label>
        <label>Pay max (hourly)
          <input type="number" step="0.01" name="job_pay_max" required placeholder="25">
        </label>
      </div>

      <!-- Requirements -->
      <label>Must-have skills (comma-separated)
        <textarea name="musts" rows="2" required placeholder="help desk, windows, ticketing"></textarea>
      </label>
      <label>Nice-to-haves (comma-separated)
        <textarea name="nice" rows="2" placeholder="azure, scripting, itil"></textarea>
      </label>

      <!-- Reply-time pledge -->
      <label>Reply-time pledge (SLA)
        <select name="reply_sla" required>
          <option value="<=2h">&le; 2 hours (Fast-Reply Certified)</option>
          <option value="same-day">Same day</option>
          <option value="48h">Within 48 hours</option>
        </select>
      </label>

      <!-- Optional scheduling link (helps fast replies) -->
      <label>Optional: Calendly / phone for fast scheduling
        <input name="contact_channel" placeholder="https://calendly.com/your-link or phone number">
      </label>

      <!-- Metadata -->
      <input type="hidden" name="_subject">
      <input type="hidden" name="source">
      <input type="hidden" name="_redirect">
      <!-- Honeypot (spam trap) -->
      <label style="display:none">Leave this empty <input name="website"></label>

      <label><input type="checkbox" name="consent" required> I agree to the <a href="terms.html">Terms</a> and <a href="privacy.html">Privacy Policy</a>.</label>
      <button type="submit">Submit job</button>
      <small class="note">By submitting, you agree to the reply-time pledge; badge visibility depends on measured reply speed.</small>
    </form>
  </div>
</main>

<script>
  // AJAX submit to keep user on-page with a success message
  const f = document.getElementById('jobForm');
  f.addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = f.querySelector('button[type="submit"]');
    btn.disabled = true; btn.textContent = 'Sending‚Ä¶';
    try{
      const res = await fetch(f.action, {
        method: 'POST',
        body: new FormData(f),
        headers: { 'Accept': 'application/json' }
      });
      if(res.ok){
        document.getElementById('wrap').innerHTML =
          '<h2>Thanks ‚Äî your job is posted.</h2><p class="sub">We'll verify your reply-time pledge and display your <b>Fast-Reply</b> badge accordingly.</p><p style="margin-top: 20px;"><a href="https://buy.stripe.com/8x25kC7gS1zz6AxeFk5Rm00" target="_blank" rel="noopener" style="display: inline-block; margin-top: 16px; padding: 12px 16px; border-radius: 12px; border: 1px solid #0F172A; background: #0F172A; color: #fff; font-weight: 700; text-decoration: none;">Feature this job ($25)</a></p>';
      }else{
        btn.disabled = false; btn.textContent = 'Submit job';
        alert('Something went wrong. Please try again.');
      }
    }catch(err){
      btn.disabled = false; btn.textContent = 'Submit job';
      alert('Network error. Please try again.');
    }
  });

  // Handle URL parameters from cohort.html intro requests
  function handleURLParams() {
    const params = new URLSearchParams(window.location.search);
    const role = params.get('role');
    const candidate = params.get('candidate');
    const source = params.get('source');

    if (role) {
      // Pre-fill the job title with the role
      const jobTitleField = document.querySelector('input[name="job_title"]');
      if (jobTitleField) {
        jobTitleField.value = role;
      }
    }

    if (candidate && source === 'cohort_intro') {
      // Show a helpful banner about the intro request
      const form = document.getElementById('jobForm');
      const banner = document.createElement('div');
      banner.style.cssText = `
        background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
        border: 1px solid #4a9eff;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 16px;
        color: #1e3a5f;
        font-size: 14px;
        text-align: center;
      `;
      banner.innerHTML = `
        <strong>ü§ù Intro Request:</strong> You're posting a job for <strong>${role}</strong> 
        after viewing <strong>${candidate}'s</strong> profile. They'll be notified when you post!
      `;
      form.parentNode.insertBefore(banner, form);

      // Add hidden field to track the intro source
      const hiddenInput = document.createElement('input');
      hiddenInput.type = 'hidden';
      hiddenInput.name = 'intro_candidate';
      hiddenInput.value = candidate;
      form.appendChild(hiddenInput);
    }
  }

  // Run URL param handler on page load
  document.addEventListener('DOMContentLoaded', handleURLParams);
</script>